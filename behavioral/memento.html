<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>备忘录模式 | 印客学院</title>
    <meta name="generator" content="VuePress 1.9.9">
    <link rel="icon" href="/design-pattern/img/logo.png">
    <meta name="description" content="设计模式深入浅出">
    <meta name="keywords" content="设计模式深入浅出">
    
    <link rel="preload" href="/design-pattern/assets/css/0.styles.ed4adf79.css" as="style"><link rel="preload" href="/design-pattern/assets/js/app.c5837f5d.js" as="script"><link rel="preload" href="/design-pattern/assets/js/2.87c55b2d.js" as="script"><link rel="preload" href="/design-pattern/assets/js/3.5df15920.js" as="script"><link rel="prefetch" href="/design-pattern/assets/js/10.09fcd684.js"><link rel="prefetch" href="/design-pattern/assets/js/11.2c0a60d5.js"><link rel="prefetch" href="/design-pattern/assets/js/12.e4cd9b0b.js"><link rel="prefetch" href="/design-pattern/assets/js/13.e2e85962.js"><link rel="prefetch" href="/design-pattern/assets/js/14.77f4c8de.js"><link rel="prefetch" href="/design-pattern/assets/js/15.bdbe88d9.js"><link rel="prefetch" href="/design-pattern/assets/js/16.c93a16f5.js"><link rel="prefetch" href="/design-pattern/assets/js/17.8f0ac95a.js"><link rel="prefetch" href="/design-pattern/assets/js/18.97946bbf.js"><link rel="prefetch" href="/design-pattern/assets/js/19.9a2df0b1.js"><link rel="prefetch" href="/design-pattern/assets/js/20.0c56a87c.js"><link rel="prefetch" href="/design-pattern/assets/js/21.fa885a2e.js"><link rel="prefetch" href="/design-pattern/assets/js/22.58280c1b.js"><link rel="prefetch" href="/design-pattern/assets/js/23.7d96885f.js"><link rel="prefetch" href="/design-pattern/assets/js/24.eb250086.js"><link rel="prefetch" href="/design-pattern/assets/js/25.81aa5aa0.js"><link rel="prefetch" href="/design-pattern/assets/js/26.51549590.js"><link rel="prefetch" href="/design-pattern/assets/js/27.5bc5ec09.js"><link rel="prefetch" href="/design-pattern/assets/js/4.1678dc1d.js"><link rel="prefetch" href="/design-pattern/assets/js/5.09261db1.js"><link rel="prefetch" href="/design-pattern/assets/js/6.22f7e7d7.js"><link rel="prefetch" href="/design-pattern/assets/js/7.fc595223.js"><link rel="prefetch" href="/design-pattern/assets/js/8.77b29604.js"><link rel="prefetch" href="/design-pattern/assets/js/9.3c9fc99c.js">
    <link rel="stylesheet" href="/design-pattern/assets/css/0.styles.ed4adf79.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/design-pattern/" class="home-link router-link-active"><img src="/design-pattern/img/logo.png" alt="印客学院" class="logo"> <span class="site-name can-hide">印客学院</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/design-pattern/index.html" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="设计模式" class="dropdown-title"><span class="title">设计模式</span> <span class="arrow down"></span></button> <button type="button" aria-label="设计模式" class="mobile-dropdown-title"><span class="title">设计模式</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/design-pattern/creational/index.html" class="nav-link">
  创建者模式
</a></li><li class="dropdown-item"><!----> <a href="/design-pattern/structural/index.html" class="nav-link">
  结构型模式
</a></li><li class="dropdown-item"><!----> <a href="/design-pattern/behavioral/index.html" class="nav-link">
  行为模式
</a></li></ul></div></div> <a href="https://github.com/encode-studio-fe/design-pattern" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/design-pattern/index.html" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="设计模式" class="dropdown-title"><span class="title">设计模式</span> <span class="arrow down"></span></button> <button type="button" aria-label="设计模式" class="mobile-dropdown-title"><span class="title">设计模式</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/design-pattern/creational/index.html" class="nav-link">
  创建者模式
</a></li><li class="dropdown-item"><!----> <a href="/design-pattern/structural/index.html" class="nav-link">
  结构型模式
</a></li><li class="dropdown-item"><!----> <a href="/design-pattern/behavioral/index.html" class="nav-link">
  行为模式
</a></li></ul></div></div> <a href="https://github.com/encode-studio-fe/design-pattern" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><a href="/design-pattern/creational" class="sidebar-heading clickable"><span>创建者模式</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/design-pattern/structural" class="sidebar-heading clickable"><span>结构型模式</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/design-pattern/behavioral" class="sidebar-heading clickable router-link-active open"><span>行为模式</span> <span class="arrow down"></span></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/design-pattern/behavioral/responsibility.html" class="sidebar-link">责任链模式</a></li><li><a href="/design-pattern/behavioral/command.html" class="sidebar-link">命令模式</a></li><li><a href="/design-pattern/behavioral/iterator.html" class="sidebar-link">迭代器模式</a></li><li><a href="/design-pattern/behavioral/mediator.html" class="sidebar-link">中介者模式</a></li><li><a href="/design-pattern/behavioral/memento.html" aria-current="page" class="active sidebar-link">备忘录模式</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/design-pattern/behavioral/memento.html#结构" class="sidebar-link">结构</a></li><li class="sidebar-sub-header"><a href="/design-pattern/behavioral/memento.html#适用场景" class="sidebar-link">适用场景</a></li><li class="sidebar-sub-header"><a href="/design-pattern/behavioral/memento.html#优缺点" class="sidebar-link">优缺点</a></li><li class="sidebar-sub-header"><a href="/design-pattern/behavioral/memento.html#与其他模式的关系" class="sidebar-link">与其他模式的关系</a></li><li class="sidebar-sub-header"><a href="/design-pattern/behavioral/memento.html#代码实现" class="sidebar-link">代码实现</a></li><li class="sidebar-sub-header"><a href="/design-pattern/behavioral/memento.html#测试用例" class="sidebar-link">测试用例</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="备忘录模式"><a href="#备忘录模式" class="header-anchor">#</a> 备忘录模式</h1> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p><strong>备忘录模式</strong>是一种行为设计模式， 允许在不暴露对象实现细节的情况下保存和恢复对象之前的状态。</p></div> <h2 id="结构"><a href="#结构" class="header-anchor">#</a> 结构</h2> <h3 id="基于嵌套类的实现"><a href="#基于嵌套类的实现" class="header-anchor">#</a> 基于嵌套类的实现</h3> <p><img src="data:image/png;base64,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" alt="memento_structure"></p> <ol><li>原发器 （<code>Originator</code>） 类可以生成自身状态的快照， 也可以在需要时通过快照恢复自身状态。</li> <li>备忘录 （<code>Memento</code>） 是原发器状态快照的值对象 （value object）。 通常做法是将备忘录设为不可变的， 并通过构造函数一次性传递数据。</li> <li>负责人 （<code>Caretaker</code>） 仅知道 “何时” 和 “为何” 捕捉原发器的状态， 以及何时恢复状态。负责人通过保存备忘录栈来记录原发器的历史状态。 当原发器需要回溯历史状态时， 负责人将从栈中获取最顶部的备忘录， 并将其传递给原发器的恢复 （restoration） 方法。</li> <li>在该实现方法中， 备忘录类将被嵌套在原发器中。 这样原发器就可访问备忘录的成员变量和方法， 即使这些方法被声明为私有。 另一方面， 负责人对于备忘录的成员变量和方法的访问权限非常有限： 它们只能在栈中保存备忘录， 而不能修改其状态。</li></ol> <h3 id="基于中间接口的实现"><a href="#基于中间接口的实现" class="header-anchor">#</a> 基于中间接口的实现</h3> <p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAjAAAAFeCAMAAACsOdXqAAAAnFBMVEVHcExbW1tISEhISEhJSUl6enrk5OT39/fIyMijo6ONjY2ZmZm3t7fx8fHS0tKysrLDw8Nzc3NMTEzu7u7n5+fq6uqenp5tbW2SkpKAgIDAwMDh4eG8vLzNzc309PTe3t7W1tZUVFTr6+tmZmZhYWFPT0+tra2GhoZbW1va2tqoqKhlZWV1dXVlZWVmZmZlZWVmZmbCwsLCwsLDw8Otz7pdAAAANHRSTlMAI6bp////////////////////////////////////////////////////VhC38YvatbTUcMzScgAAH99JREFUeAHs0jEBRCEMBbBCC/h3fBJu/G9INKQAAAAAAPhj7Z4svVeRavXk6VWE2nPuy3LP7CJUz31p7nQRaublmakQCIMwCPMdhEEYfuzdi5qayNoF4KdnFixUzkcFQRAQsA/p+7+6P8huK/b0ZHf849aO35qjX4SnSF6soqvALwHGmM0XpsX/Httx7x6MgNE9APADfpww4jExvLsHI2A0IFnOV/w4HkwBoyJgmAILHpIZ67wgN2WRu2TkOjlZVpiVAbd56oYTGKssAxa5mQbHtwqYewKzQBVwjAcAdcAGGlquKwCehTHpDgBa4wAmRhVmCYCqnN4qYO4LjIaEhyyTTgMcNkDvhS3qeYudBzRenverroI2gslaONRQzRt401sFzH2BSaDxGA8xG3SkgzbgHHP2MHnIDM0IZgWPAbBmjmp6q4C5LzAdah5SrvoWBzA7Mgba1kc3gbEWdQXUYxVtxgHw2xbt9FYBc19gYsAmybCCFzfYv4GpFt/jTmA09IsVkrFaQeMAzL//4l7A3COY0kefF0G6BqLgCMYEMlIne8QMfOy4PIDxHCC1fOzJ0LpRMLJmVq2KvQAYLgD4QApULTCbFAQVfC/xdWpAb/bw+6lL8ooEjdUBtdbubh2MrJn9++ECYIpdBaAvl0CyR8cGDsm8B5CUXFfAPq3Qm21bxPBoA/tIA9A701s/HUDWzN7qqljg1/Zs6yStLVkUqlgGHKt2RBbhyS+RW/vXjx+QNbO3typWZqtVZPkAIGAEjID5ihEwAkbACBgBI2AEjIARMPp+y58mcGbr4pJgbvFWWQHzr9nDoYrFf8Tzm56XBHOLN+MLmH9N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" alt="memento_middleware_structure"></p> <ol><li>在没有嵌套类的情况下， 你可以规定负责人仅可通过明确声明的中间接口与备忘录互动， 该接口仅声明与备忘录元数据相关的方法， 限制其对备忘录成员变量的直接访问权限。</li> <li>另一方面， 原发器可以直接与备忘录对象进行交互， 访问备忘录类中声明的成员变量和方法。 这种方式的缺点在于你需要将备忘录的所有成员变量声明为公有。</li></ol> <h3 id="封装更加严格的实现"><a href="#封装更加严格的实现" class="header-anchor">#</a> 封装更加严格的实现</h3> <p><img src="data:image/png;base64,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" alt="memento_strict_structure"></p> <ol><li>这种实现方式允许存在多种不同类型的原发器和备忘录。 每种原发器都和其相应的备忘录类进行交互。 原发器和备忘录都不会将其状态暴露给其他类。</li> <li>负责人此时被明确禁止修改存储在备忘录中的状态。 但负责人类将独立于原发器， 因为此时恢复方法被定义在了备忘录类中。</li> <li>每个备忘录将与创建了自身的原发器连接。 原发器会将自己及状态传递给备忘录的构造函数。 由于这些类之间的紧密联系， 只要原发器定义了合适的设置器 （setter）， 备忘录就能恢复其状态。</li></ol> <h2 id="适用场景"><a href="#适用场景" class="header-anchor">#</a> 适用场景</h2> <ol><li><p>当你需要创建对象状态快照来恢复其之前的状态时， 可以使用备忘录模式。</p> <ol><li>备忘录模式允许你复制对象中的全部状态 （包括私有成员变量）， 并将其独立于对象进行保存。 尽管大部分人因为 “撤销” 这个用例才记得该模式， 但其实它在处理事务 （比如需要在出现错误时回滚一个操作） 的过程中也必不可少。</li></ol></li> <li><p>当直接访问对象的成员变量、 获取器或设置器将导致封装被突破时， 可以使用该模式。</p> <ol><li>备忘录让对象自行负责创建其状态的快照。 任何其他对象都不能读取快照， 这有效地保障了数据的安全性。</li></ol></li></ol> <h2 id="优缺点"><a href="#优缺点" class="header-anchor">#</a> 优缺点</h2> <h3 id="优点"><a href="#优点" class="header-anchor">#</a> 优点</h3> <ol><li>你可以在不破坏对象封装情况的前提下创建对象状态快照。</li> <li>你可以通过让负责人维护原发器状态历史记录来简化原发器代码。</li></ol> <h3 id="缺点"><a href="#缺点" class="header-anchor">#</a> 缺点</h3> <ol><li>如果客户端过于频繁地创建备忘录， 程序将消耗大量内存。</li> <li>负责人必须完整跟踪原发器的生命周期， 这样才能销毁弃用的备忘录。</li> <li>绝大部分动态编程语言 （例如 PHP、 Python 和 JavaScript） 不能确保备忘录中的状态不被修改。</li></ol> <h2 id="与其他模式的关系"><a href="#与其他模式的关系" class="header-anchor">#</a> 与其他模式的关系</h2> <ol><li>你可以同时使用命令模式和备忘录模式来实现 “撤销”。 在这种情况下， 命令用于对目标对象执行各种不同的操作， 备忘录用来保存一条命令执行前该对象的状态。</li> <li>你可以同时使用备忘录和迭代器模式来获取当前迭代器的状态， 并且在需要的时候进行回滚。</li> <li>有时候原型模式可以作为备忘录的一个简化版本， 其条件是你需要在历史记录中存储的对象的状态比较简单， 不需要链接其他外部资源， 或者链接可以方便地重建。</li></ol> <h2 id="代码实现"><a href="#代码实现" class="header-anchor">#</a> 代码实现</h2> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">class</span> <span class="token class-name">Originator</span> <span class="token punctuation">{</span>
	<span class="token keyword">private</span> state<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>

	<span class="token function">constructor</span><span class="token punctuation">(</span>state<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> state<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">public</span> <span class="token function">doSomething</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">string</span> <span class="token punctuation">{</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">generateRandomString</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">private</span> <span class="token function">generateRandomString</span><span class="token punctuation">(</span>length<span class="token operator">:</span> <span class="token builtin">number</span> <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">string</span> <span class="token punctuation">{</span>
		<span class="token keyword">const</span> charSet <span class="token operator">=</span> <span class="token string">'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ'</span><span class="token punctuation">;</span>

		<span class="token keyword">return</span> <span class="token function">Array</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> length <span class="token punctuation">}</span><span class="token punctuation">)</span>
			<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> charSet<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> charSet<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
			<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">public</span> <span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> Memento <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">ConcreteMemento</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">public</span> <span class="token function">restore</span><span class="token punctuation">(</span>memento<span class="token operator">:</span> Memento<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">string</span> <span class="token punctuation">{</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> memento<span class="token punctuation">.</span><span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">interface</span> <span class="token class-name">Memento</span> <span class="token punctuation">{</span>
	<span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>

	<span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>

	<span class="token function">getDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">ConcreteMemento</span> <span class="token keyword">implements</span> <span class="token class-name">Memento</span> <span class="token punctuation">{</span>
	<span class="token keyword">private</span> state<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>

	<span class="token keyword">private</span> date<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>

	<span class="token function">constructor</span><span class="token punctuation">(</span>state<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> state<span class="token punctuation">;</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>date <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toISOString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">'T'</span><span class="token punctuation">,</span> <span class="token string">' '</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">public</span> <span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">string</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">public</span> <span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">string</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>date<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> / (</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">...)</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">public</span> <span class="token function">getDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">string</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>date<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Caretaker</span> <span class="token punctuation">{</span>
	<span class="token keyword">private</span> mementos<span class="token operator">:</span> Memento<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

	<span class="token keyword">private</span> originator<span class="token operator">:</span> Originator<span class="token punctuation">;</span>

	<span class="token function">constructor</span><span class="token punctuation">(</span>originator<span class="token operator">:</span> Originator<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>originator <span class="token operator">=</span> originator<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">public</span> <span class="token function">backup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span> <span class="token punctuation">{</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>mementos<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>originator<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">public</span> <span class="token function">undo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">string</span> <span class="token punctuation">{</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>mementos<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">return</span> <span class="token string">''</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">const</span> memento <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>mementos<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>originator<span class="token punctuation">.</span><span class="token function">restore</span><span class="token punctuation">(</span>memento<span class="token operator">!</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">public</span> <span class="token function">showHistory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span> <span class="token punctuation">{</span>
		<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> memento <span class="token keyword">of</span> <span class="token keyword">this</span><span class="token punctuation">.</span>mementos<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>memento<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token punctuation">{</span> Originator<span class="token punctuation">,</span> Memento<span class="token punctuation">,</span> ConcreteMemento<span class="token punctuation">,</span> Caretaker <span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="测试用例"><a href="#测试用例" class="header-anchor">#</a> 测试用例</h2> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Originator<span class="token punctuation">,</span> Caretaker <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'../index'</span><span class="token punctuation">;</span>

<span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">'memento pattern'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
	<span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'memento concrete creator'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
		<span class="token keyword">const</span> originator <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Originator</span><span class="token punctuation">(</span><span class="token string">'Super-duper-super-puper-super.'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">const</span> caretaker <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Caretaker</span><span class="token punctuation">(</span>originator<span class="token punctuation">)</span><span class="token punctuation">;</span>

		caretaker<span class="token punctuation">.</span><span class="token function">backup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">const</span> backUp1 <span class="token operator">=</span> originator<span class="token punctuation">.</span><span class="token function">doSomething</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		caretaker<span class="token punctuation">.</span><span class="token function">backup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">const</span> backUp2 <span class="token operator">=</span> originator<span class="token punctuation">.</span><span class="token function">doSomething</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		caretaker<span class="token punctuation">.</span><span class="token function">backup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		caretaker<span class="token punctuation">.</span><span class="token function">showHistory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token function">expect</span><span class="token punctuation">(</span>caretaker<span class="token punctuation">.</span><span class="token function">undo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span>backUp2<span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token function">expect</span><span class="token punctuation">(</span>caretaker<span class="token punctuation">.</span><span class="token function">undo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span>backUp1<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/design-pattern/behavioral/mediator.html" class="prev">
        中介者模式
      </a></span> <!----></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/design-pattern/assets/js/app.c5837f5d.js" defer></script><script src="/design-pattern/assets/js/2.87c55b2d.js" defer></script><script src="/design-pattern/assets/js/3.5df15920.js" defer></script>
  </body>
</html>
